% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway-vote.R
\name{pathway_vote}
\alias{pathway_vote}
\title{Pathway Voting-Based Enrichment Analysis}
\usage{
pathway_vote(
  ewas_data,
  eQTM,
  databases = c("Reactome"),
  k_grid = NULL,
  stat_grid = NULL,
  distance_grid = NULL,
  fixed_prune = NULL,
  grid_size = 5,
  min_genes_per_hit = 3,
  readable = FALSE,
  workers = NULL,
  verbose = FALSE
)
}
\arguments{
\item{ewas_data}{A data.frame with columns: `cpg` and a numeric ranking column (e.g., p-value, t-statistics, variable importance). The second column will be used as the ranking metric.}

\item{eQTM}{An eQTM object containing eQTM data.}

\item{databases}{A character vector of pathway databases. Supporting: "Reactome", "KEGG", and "GO".}

\item{k_grid}{A numeric vector of top-k CpGs to consider for gene set construction. If NULL, automatically inferred based on inflection point detection from the ranking curve.}

\item{stat_grid}{A numeric vector of eQTM statistic thresholds. If NULL, generated based on quantiles of the observed distribution.}

\item{distance_grid}{A numeric vector of CpG-gene distance thresholds (in base pairs). If NULL, generated similarly.}

\item{fixed_prune}{Integer or NULL. Minimum number of votes to retain a pathway. If NULL, will use cuberoot(N) where N is the number of enrichment runs.}

\item{grid_size}{Integer. Number of values in each grid when auto-generating. Default is 5.}

\item{min_genes_per_hit}{Minimum number of genes (`Count`) a pathway must include to be considered.}

\item{readable}{Logical. whether to convert Entrez IDs to gene symbols in enrichment results.}

\item{workers}{Optional integer. Number of parallel workers. If NULL, use 2 logical cores.}

\item{verbose}{Logical. whether to print progress messages.}
}
\value{
A named list of data.frames, each corresponding to a selected pathway database
(e.g., `Reactome`, `KEGG`, `GO`). Each data.frame contains enriched pathways with
columns: `ID`, `p.adjust`, `Description`, and `geneID`.
}
\description{
Performs pathway enrichment analysis using a voting-based framework that integrates
CpG-gene regulatory information from expression quantitative trait methylation (eQTM) data.
For a grid of top-ranked CpGs and filtering thresholds, gene sets are generated and filtered using
an entropy-based pruning strategy that balances information richness and stability. Enrichment results
across parameter combinations are aggregated using a voting scheme, prioritizing
pathways that consistently appear under diverse settings.
}
\examples{
set.seed(123)

# Simulated EWAS result: a mix of signal and noise
ewas_data <- data.frame(
  cpg = paste0("cg", sprintf("\%06d", 1:20)),
  p_value = c(runif(5, 1e-5, 0.001), runif(5, 0.01, 0.05), runif(10, 0.1, 1))
)

# Corresponding eQTM mapping (some of these CpGs have gene links)
eqtm_data <- data.frame(
  cpg = ewas_data$cpg,
  statistics = rnorm(20, mean = 2, sd = 1),
  p_value = runif(20, 0.001, 0.05),
  distance = sample(1000:100000, 20),
  entrez = rep(c("5290", "673", "1956", "7157", "7422"), length.out = 20)
)
eqtm_obj <- create_eQTM(eqtm_data)

results <- pathway_vote(
  ewas_data = data,
  eQTM = eqtm_obj,
  databases = c("KEGG"),
  worker = NULL, # If not specified, will use 2 cores by default
  verbose = TRUE
)
head(results$KEGG)

}
