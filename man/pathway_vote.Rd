% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pathway-vote.R
\name{pathway_vote}
\alias{pathway_vote}
\title{Pathway Vote}
\usage{
pathway_vote(
  ewas_data,
  eQTM,
  databases = c("Reactome"),
  rank_column = "p_value",
  rank_decreasing = FALSE,
  use_abs = FALSE,
  k_grid = NULL,
  stat_grid = NULL,
  distance_grid = NULL,
  overlap_threshold = NULL,
  fixed_prune = NULL,
  grid_size = 5,
  min_genes_per_hit = 3,
  readable = FALSE,
  workers = NULL,
  verbose = FALSE
)
}
\arguments{
\item{ewas_data}{A data.frame with columns: cpg and a ranking column (e.g., p_value, score).}

\item{eQTM}{An eQTM object containing eQTM data.}

\item{databases}{A character vector of pathway databases (e.g., "Reactome").}

\item{rank_column}{A character string indicating which column in `ewas_data` to use for ranking.}

\item{rank_decreasing}{Logical. If TRUE (default), sorts CpGs from high to low based on `rank_column`.}

\item{use_abs}{Logical. Whether to apply `abs()` to the ranking column before sorting CpGs.}

\item{k_grid}{A numeric vector of top k CpGs to select. If NULL, inferred automatically.}

\item{stat_grid}{A numeric vector of statistics thresholds. If NULL, inferred automatically.}

\item{distance_grid}{A numeric vector of distance thresholds. If NULL, inferred automatically.}

\item{overlap_threshold}{A numeric value for gene list overlap threshold. If NULL, inferred automatically.}

\item{fixed_prune}{Integer or NULL. Minimum number of votes to retain a pathway. If NULL, will use cuberoot(N) where N is the number of enrichment runs.}

\item{grid_size}{Integer. Number of values in each grid when auto-generating. Default is 5.}

\item{min_genes_per_hit}{Minimum number of genes (`Count`) a pathway must include to be considered.}

\item{readable}{Logical. whether to convert Entrez IDs to gene symbols in enrichment results.}

\item{workers}{Optional integer. Number of parallel workers. If NULL, use 2 logical cores.}

\item{verbose}{Logical. whether to print progress messages.}
}
\value{
A named list of data.frames, each containing enrichment results (pathway ID, p.adjust, Description, geneID) for one database (e.g., Reactome, KEGG).
}
\description{
Performs methylation pathway enrichment analysis using a voting-based approach.
}
\examples{
set.seed(123)

# Simulated EWAS result: a mix of signal and noise
ewas_data <- data.frame(
  cpg = paste0("cg", sprintf("\%06d", 1:20)),
  p_value = c(runif(5, 1e-5, 0.001), runif(5, 0.01, 0.05), runif(10, 0.1, 1))
)

# Corresponding eQTM mapping (some of these CpGs have gene links)
eqtm_data <- data.frame(
  cpg = ewas_data$cpg,
  statistics = rnorm(20, mean = 2, sd = 1),
  p_value = runif(20, 0.001, 0.05),
  distance = sample(1000:100000, 20),
  entrez = rep(c("5290", "673", "1956", "7157", "7422"), length.out = 20)
)
eqtm_obj <- create_eQTM(eqtm_data)

results <- pathway_vote(
  ewas_data = data,
  eQTM = eqtm_obj,
  databases = c("KEGG"),
  rank_column = "p_value",
  rank_decreasing = FALSE,
  use_abs = FALSE,
  worker = 1, # If not specified, will use 2 cores by default
  verbose = TRUE
)

}
